{"ast":null,"code":"var _jsxFileName = \"/Users/osydir/Documents/LPNU/WEB/notes/src/components/Note/Note.js\";\nimport React from \"react\";\nimport \"./Note.scss\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport axios from \"axios\";\nimport { CONFIG } from \"../../config\";\nimport Auth from \"../../utils/Auth/Auth\";\nimport ManageNote from \"../ManageNote/ManageNote\";\n\nclass Note extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      note: null,\n      authors: [],\n      openedModal: false,\n      isFound: true,\n      viewedAuthorInput: false,\n      formControls: {\n        authorEmail: {\n          value: '',\n          isValid: '',\n          isBlur: '',\n          errorMessage: ''\n        }\n      }\n    };\n\n    this.componentDidMount = () => {\n      axios.get(CONFIG.apiServer + \"api/notes/\" + this.props.match.params.id, {\n        headers: {\n          'Accept': 'application/json',\n          'Authorization': 'Bearer ' + Auth.loggedApiKey\n        }\n      }).then(res => {\n        this.setState({\n          note: res.data.data\n        });\n        axios.get(CONFIG.apiServer + \"api/authors/note/\" + this.props.match.params.id, {\n          headers: {\n            'Accept': 'application/json',\n            'Authorization': 'Bearer ' + Auth.loggedApiKey\n          }\n        }).then(res => {\n          this.setState({\n            authors: res.data.data\n          });\n        });\n      }).catch(error => {\n        this.setState({\n          isFound: false\n        });\n      });\n    };\n\n    this.renderAuthors = () => {\n      return this.state.authors.map((author, index) => /*#__PURE__*/React.createElement(\"li\", {\n        key: index,\n        className: author.is_creator === 1 ? \"main-author\" : \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 17\n        }\n      }, !author.is_creator ? /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n        icon: \"trash-alt\",\n        onClick: () => {\n          this.deleteAuthor(author);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 43\n        }\n      }) : '', author.name, \" \", /*#__PURE__*/React.createElement(\"small\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 35\n        }\n      }, \"(\", author.email, \")\")));\n    };\n\n    this.deleteAuthor = author => {\n      const authors = [...this.state.authors];\n      var index = authors.indexOf(author);\n\n      if (index > -1) {\n        axios.delete(CONFIG.apiServer + \"api/authors/\" + author.id, {\n          headers: {\n            'Accept': 'application/json',\n            'Authorization': 'Bearer ' + Auth.loggedApiKey\n          }\n        }).then(res => {\n          authors.splice(index, 1);\n          this.setState({\n            authors\n          });\n        }).catch(error => {\n          alert('Unknown error. Please reload page and try it one more time.');\n        });\n      }\n    };\n\n    this.onClosePopup = () => {\n      this.setState({\n        openedModal: false\n      });\n    };\n\n    this.onChangeNote = note => {\n      this.setState({\n        note: note\n      });\n    };\n\n    this.deleteNote = () => {\n      if (window.confirm('Do you really want to delete this note?')) {\n        axios.delete(CONFIG.apiServer + \"api/notes/\" + this.state.note.id, {\n          headers: {\n            'Accept': 'application/json',\n            'Authorization': 'Bearer ' + Auth.loggedApiKey\n          }\n        }).then(res => {\n          window.location.href = \"/\";\n        }).catch(() => {\n          alert('Unknown error. Please reload page and try it one more time.');\n        });\n      }\n    };\n\n    this.inputOnBlurHandler = controlName => {\n      const formControls = { ...this.state.formControls\n      };\n      formControls[controlName].isBlur = true;\n      this.setState(formControls);\n    };\n\n    this.inputOnChangeHandler = (e, controlName) => {\n      const formControls = { ...this.state.formControls\n      };\n      formControls[controlName].value = e.target.value;\n      formControls[controlName].errorMessage = '';\n      formControls[controlName].isValid = true;\n\n      if (formControls[controlName].value.length === 0) {\n        formControls[controlName].errorMessage = 'This field is required.';\n        formControls[controlName].isValid = false;\n      }\n\n      if (controlName === 'authorEmail') {\n        // eslint-disable-next-line\n        let validEmailRegex = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n        if (!validEmailRegex.test(formControls[controlName].value)) {\n          formControls[controlName].errorMessage = 'Invalid email.';\n          formControls[controlName].isValid = false;\n        }\n      }\n\n      this.setState({\n        formControls\n      });\n    };\n\n    this.onAddAuthor = () => {\n      if (this.state.formControls.authorEmail.isValid) {\n        axios.post(CONFIG.apiServer + \"api/authors/note/\" + this.state.note.id, {\n          email: this.state.formControls.authorEmail.value\n        }, {\n          headers: {\n            'Accept': 'application/json',\n            'Authorization': 'Bearer ' + Auth.loggedApiKey\n          }\n        }).then(res => {\n          const authors = [...this.state.authors];\n          authors.push(res.data.data);\n          this.setState({\n            viewedAuthorInput: false,\n            authors: authors\n          });\n        }).catch(error => {\n          const formControls = { ...this.state.formControls\n          };\n\n          if (error.response.data.data.note_id) {\n            formControls.authorEmail.errorMessage = error.response.data.data.note_id;\n            formControls.authorEmail.isValid = false;\n          } else if (error.response.data.data.email) {\n            formControls.authorEmail.errorMessage = error.response.data.data.email;\n            formControls.authorEmail.isValid = false;\n          } else {\n            alert('Unknown error. Please reload page and try it one more time.');\n          }\n\n          this.setState({\n            formControls\n          });\n        });\n      }\n    };\n\n    this.renderFunctionalityToAddAuthor = () => {\n      if (!this.state.viewedAuthorInput) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: 'u123',\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btn note-add-new\",\n          onClick: () => {\n            this.setState({\n              viewedAuthorInput: true\n            });\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n          icon: \"user-plus\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 25\n          }\n        }), \" Add new\"));\n      } else {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: 'u123',\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"form-group\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          className: \"form-control\",\n          value: this.state.formControls.authorEmail.value,\n          onChange: e => {\n            this.inputOnChangeHandler(e, 'authorEmail');\n          },\n          onBlur: e => {\n            this.inputOnBlurHandler('authorEmail');\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"small\", {\n          className: \"error-message\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 25\n          }\n        }, this.state.formControls.authorEmail.isBlur && !this.state.formControls.authorEmail.isValid ? this.state.formControls.authorEmail.errorMessage : '')), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"form-group\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btn note-add-new\",\n          onClick: this.onAddAuthor,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n          icon: \"user-plus\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 89\n          }\n        }), \" Add\")));\n      }\n    };\n  }\n\n  render() {\n    if (this.state.isFound && !this.state.note) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"default-block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 25\n        }\n      }, \"Loading...\")));\n    }\n\n    if (!this.state.isFound) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"default-block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 25\n        }\n      }, \"Note not found!\")));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ManageNote, {\n      isOpened: this.state.openedModal,\n      onClosePopup: this.onClosePopup,\n      editMode: true,\n      note: this.state.note,\n      onChangeNote: this.onChangeNote,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"default-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"option-buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"edit-btn option-button\",\n      onClick: () => {\n        this.setState({\n          openedModal: true\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: \"pen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 36\n      }\n    }), \" Edit\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"delete-btn option-button\",\n      onClick: this.deleteNote,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: \"trash-alt\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 104\n      }\n    }), \" Delete\")), /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"block-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 29\n      }\n    }, this.state.note.title), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"note-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 33\n      }\n    }, this.state.note.text)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"default-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"block-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 29\n      }\n    }, \"Authors\"), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"note-authors\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 29\n      }\n    }, this.renderAuthors(), this.renderFunctionalityToAddAuthor())))));\n  }\n\n}\n\nexport default Note;","map":{"version":3,"sources":["/Users/osydir/Documents/LPNU/WEB/notes/src/components/Note/Note.js"],"names":["React","FontAwesomeIcon","axios","CONFIG","Auth","ManageNote","Note","Component","state","note","authors","openedModal","isFound","viewedAuthorInput","formControls","authorEmail","value","isValid","isBlur","errorMessage","componentDidMount","get","apiServer","props","match","params","id","headers","loggedApiKey","then","res","setState","data","catch","error","renderAuthors","map","author","index","is_creator","deleteAuthor","name","email","indexOf","delete","splice","alert","onClosePopup","onChangeNote","deleteNote","window","confirm","location","href","inputOnBlurHandler","controlName","inputOnChangeHandler","e","target","length","validEmailRegex","test","onAddAuthor","post","push","response","note_id","renderFunctionalityToAddAuthor","render","title","text"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./Note.scss\";\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport axios from \"axios\";\nimport {CONFIG} from \"../../config\";\nimport Auth from \"../../utils/Auth/Auth\";\nimport ManageNote from \"../ManageNote/ManageNote\";\n\nclass Note extends React.Component {\n\n    state = {\n        note: null,\n        authors: [],\n        openedModal: false,\n        isFound: true,\n        viewedAuthorInput: false,\n        formControls: {\n            authorEmail: {\n                value: '',\n                isValid: '',\n                isBlur: '',\n                errorMessage: ''\n            }\n        }\n    }\n\n    componentDidMount = () => {\n        axios.get(CONFIG.apiServer + \"api/notes/\" + this.props.match.params.id, {\n            headers: {\n                'Accept': 'application/json',\n                'Authorization': 'Bearer ' + Auth.loggedApiKey\n            }\n        }).then((res) => {\n            this.setState({\n                note: res.data.data\n            });\n            axios.get(CONFIG.apiServer + \"api/authors/note/\" + this.props.match.params.id, {\n                headers: {\n                    'Accept': 'application/json',\n                    'Authorization': 'Bearer ' + Auth.loggedApiKey\n                }\n            }).then((res) => {\n                this.setState({\n                    authors: res.data.data\n                });\n            })\n        }).catch((error) => {\n            this.setState({isFound: false});\n        });\n    }\n\n    renderAuthors = () => {\n        return this.state.authors.map((author, index) => (\n                <li key={index} className={author.is_creator === 1 ? \"main-author\" : \"\"}>\n                    {!author.is_creator ? <FontAwesomeIcon icon=\"trash-alt\"\n                    onClick={() => {this.deleteAuthor(author)}}\n                    /> : '' }\n                    {author.name} <small>({author.email})</small>\n                    </li>\n            )\n        );\n    }\n\n    deleteAuthor = (author) => {\n        const authors = [...this.state.authors];\n        var index = authors.indexOf(author);\n        if (index > -1) {\n            axios.delete(CONFIG.apiServer + \"api/authors/\" + author.id, {\n                headers: {\n                    'Accept': 'application/json',\n                    'Authorization': 'Bearer ' + Auth.loggedApiKey\n                }\n            }).then((res) => {\n                authors.splice(index, 1);\n                this.setState({authors});\n            }).catch((error) => {\n                alert('Unknown error. Please reload page and try it one more time.');\n            });\n        }\n\n\n    }\n\n    onClosePopup = () => {\n        this.setState({openedModal: false})\n    }\n\n    onChangeNote = (note) => {\n        this.setState({note: note});\n    }\n\n    deleteNote = () => {\n        if (window.confirm('Do you really want to delete this note?')) {\n            axios.delete(CONFIG.apiServer + \"api/notes/\" + this.state.note.id, {\n                headers: {\n                    'Accept': 'application/json',\n                    'Authorization': 'Bearer ' + Auth.loggedApiKey\n                }\n            }).then((res) => {\n                window.location.href = \"/\";\n            }).catch(() => {\n                alert('Unknown error. Please reload page and try it one more time.');\n            });\n        }\n    }\n\n    inputOnBlurHandler = (controlName) => {\n        const formControls = {...this.state.formControls};\n        formControls[controlName].isBlur = true;\n        this.setState(formControls);\n    }\n\n    inputOnChangeHandler = (e, controlName) => {\n        const formControls = {...this.state.formControls};\n        formControls[controlName].value = e.target.value;\n        formControls[controlName].errorMessage = '';\n        formControls[controlName].isValid = true;\n\n        if (formControls[controlName].value.length === 0) {\n            formControls[controlName].errorMessage = 'This field is required.';\n            formControls[controlName].isValid = false;\n        }\n        if(controlName === 'authorEmail') {\n            // eslint-disable-next-line\n            let validEmailRegex = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n            if(!validEmailRegex.test(formControls[controlName].value)) {\n                formControls[controlName].errorMessage = 'Invalid email.';\n                formControls[controlName].isValid = false;\n            }\n        }\n\n        this.setState({formControls});\n    }\n\n    onAddAuthor = () => {\n        if (this.state.formControls.authorEmail.isValid) {\n            axios.post(CONFIG.apiServer + \"api/authors/note/\" + this.state.note.id, {\n                email: this.state.formControls.authorEmail.value,\n            }, {\n                headers: {\n                    'Accept': 'application/json',\n                    'Authorization': 'Bearer ' + Auth.loggedApiKey\n                }\n            }).then((res) => {\n                const authors = [...this.state.authors];\n                authors.push(res.data.data);\n                this.setState({\n                    viewedAuthorInput: false,\n                    authors: authors\n                });\n            }).catch((error) => {\n                const formControls = {...this.state.formControls};\n                if (error.response.data.data.note_id) {\n                    formControls.authorEmail.errorMessage = error.response.data.data.note_id;\n                    formControls.authorEmail.isValid = false;\n                } else if (error.response.data.data.email) {\n                    formControls.authorEmail.errorMessage = error.response.data.data.email;\n                    formControls.authorEmail.isValid = false;\n                } else {\n                    alert('Unknown error. Please reload page and try it one more time.');\n                }\n                this.setState({formControls});\n            });\n        }\n    }\n\n    renderFunctionalityToAddAuthor = () => {\n        if (!this.state.viewedAuthorInput) {\n            return (\n                <li key={'u123'}>\n                    <button className=\"btn note-add-new\" onClick={() => {this.setState({viewedAuthorInput: true})}}>\n                        <FontAwesomeIcon icon=\"user-plus\"/> Add new\n                    </button>\n                </li>\n            );\n        } else {\n            return (\n                <li key={'u123'}>\n                    <div className=\"form-group\">\n                        <input className=\"form-control\" value={this.state.formControls.authorEmail.value}\n                               onChange={(e) => {this.inputOnChangeHandler(e,'authorEmail')}}\n                               onBlur={(e) => {this.inputOnBlurHandler('authorEmail')}}/>\n                        <small className=\"error-message\">{this.state.formControls.authorEmail.isBlur && !this.state.formControls.authorEmail.isValid  ? this.state.formControls.authorEmail.errorMessage : ''}</small>\n                    </div>\n                    <div className=\"form-group\">\n                        <button className=\"btn note-add-new\" onClick={this.onAddAuthor}><FontAwesomeIcon icon=\"user-plus\"/> Add</button>\n                    </div>\n                </li>\n            );\n        }\n    }\n\n    render() {\n        if (this.state.isFound && !this.state.note) {\n            return (\n                <div className=\"container\">\n                    <div className=\"default-block\">\n                        <h5 className=\"text-center\">Loading...</h5>\n                    </div>\n                </div>\n            );\n        }\n\n        if (!this.state.isFound) {\n            return (\n                <div className=\"container\">\n                    <div className=\"default-block\">\n                        <h5 className=\"text-center\">Note not found!</h5>\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div className=\"container\">\n                <ManageNote\n                    isOpened={this.state.openedModal}\n                    onClosePopup={this.onClosePopup}\n                    editMode={true}\n                    note={this.state.note}\n                    onChangeNote={this.onChangeNote}\n                />\n                <div className=\"row\">\n                    <div className=\"col-lg-8\">\n                        <div className=\"default-block\">\n                            <div className=\"option-buttons\">\n                                <button className=\"edit-btn option-button\" onClick={() => {\n                                    this.setState({openedModal: true})\n                                }}><FontAwesomeIcon icon=\"pen\"/> Edit\n                                </button>\n                                <button className=\"delete-btn option-button\" onClick={this.deleteNote}><FontAwesomeIcon\n                                    icon=\"trash-alt\"/> Delete\n                                </button>\n                            </div>\n                            <h2 className=\"block-title\">{this.state.note.title}</h2>\n                            <div className=\"note-text\">\n                                <div>{this.state.note.text}</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"col-lg-4\">\n                        <div className=\"default-block\">\n                            <h2 className=\"block-title\">Authors</h2>\n                            <ul className=\"note-authors\">\n                                {this.renderAuthors()}\n                                {this.renderFunctionalityToAddAuthor()}\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Note;\n"]},"metadata":{},"sourceType":"module"}